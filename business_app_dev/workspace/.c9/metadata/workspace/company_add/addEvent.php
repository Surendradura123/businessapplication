{"changed":false,"filter":false,"title":"addEvent.php","tooltip":"/company_add/addEvent.php","value":"<?php\n    include '../connection.php';\n    include '../extras.php';\n    session_start();\n    \n    // Only Company can view this page\n    if (!($user_type_id == '2')){\n        header ('Location: /');\n    }\n\n    //Check if there are variables passed in $ _POST\nif(count($_POST)>0){\n\n    $event_name         = !empty($_POST['event_name']) ? $_POST['event_name'] : \"\"; /* not null */\n    $description        = !empty($_POST['description']) ? $_POST['description'] : \"\";\n    $event_address1     = !empty($_POST['event_address1']) ? $_POST['event_address1'] : \"\"; /* not null */\n    $event_address2     = !empty($_POST['event_address2']) ? $_POST['event_address2'] : \"\";\n    $event_city         = !empty($_POST['event_city']) ? $_POST['event_city'] : \"\";\n    $event_eircode      = !empty($_POST['event_eircode']) ? $_POST['event_eircode'] : \"\";\n    $date               = !empty($_POST['date']) ? $_POST['date'] : \"\";\n    $edit_date          = date(\"Y-m-d\",strtotime($date));\n    \n    $start_time         = !empty($_POST['start_time']) ? $_POST['start_time'] : \"\";\n    $edit_start_time    = $start_time.\":00\";\n    \n    $end_time           = !empty($_POST['end_time']) ? $_POST['end_time'] : \"\";\n    $edit_end_time      = $end_time.\":00\";\n    \n\n    // The requied field need to be filled in otherwise is not process\n    /* Field Required */\n    $aFieldRequired = [\n     $event_name,\n     $description,\n     $event_address1,\n     $date,\n     $start_time,  \n    ];\n    \n    \n    /* End */\n\n    /* Check Filled Fields */\n    $bFieldRequired = false;\n    foreach($aFieldRequired as $aField){\n        if(trim($aField) == \"\"){\n            $bFieldRequired = true;\n            break;\n        }\n    }\n    /* END */\n    \n    // insert data\n    $successDB = false;\n    if(!$bFieldRequired){//Insert in db only if the mandatory fields are filled.\n        $sql = \"INSERT INTO Event (event_id, company_id, event_name, description, event_address1, event_address2, event_city, event_eircode, date, start_time, end_time) \n        VALUES ('', '$company_id', '$event_name', '$description','$event_address1','$event_address2','$event_city','$event_eircode','$edit_date','$edit_start_time', '$edit_end_time')\";\n\n        $successDB = $db->query($sql);\n    }\n}\n?>\n\n\n\n<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <!-- Required meta tags -->\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n    <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\">\n\n    <!-- Bootstrap CSS -->\n\n    <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\" integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\" crossorigin=\"anonymous\">\n    <script src=\"//apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js\"></script>\n\n    <!--<link rel=\"stylesheet\" type=\"text/css\" href=\"css/css.css\" />-->\n    <link rel=\"stylesheet\" href=\"../css/style.css\">\n\n    <title>HybirdWeb</title>\n    \n    <script>\n      function countChar(val) {\n        var len = val.value.length;\n        if (len >= 255) {\n          val.value = val.value.substring(0, 255);\n        } else {\n          $('#charNum').text(255 - len);\n        }\n      };\n\n    // function myFunction() {\n    //     alert(\"Your event is submited sucessfully!\");\n    // }\n    \n    // function start_date(){\n    //   //alert(\"\");\n    //     document.getElementById(\"start_dt\").hidden=false;\n    //     document.getElementById(\"start_ndt\").hidden=true;\n    // }\n    \n    // function start_date1(){\n    //     d=new Date(document.getElementById(\"start_dt\").value);\n    //     dt=d.getDate();\n    //     mn=d.getMonth()+1;\n    //     yy=d.getFullYear();\n    //     document.getElementById(\"start_ndt\").value=yy+\"-\"+mn+\"-\"+dt\n    //     document.getElementById(\"start_ndt\").hidden=false;\n    //     document.getElementById(\"start_dt\").hidden=true;\n    // }\n    </script>\n    \n    \n</head>\n\n<body>\n    <?php echo $header_text;?>\n\n<!-- Header end -->\n  <!--<a href=\"/\">Main Index</a>&nbsp;-&nbsp;<a href=\"../company_add/index.html\">Section Index</a>-->\n    <!--navbar-->\n  <!--  <nav class=\"navbar navbar-expand-lg navbar-light bg-light\">-->\n  <!--      <a class=\"navbar-brand\" href=\"#\">Navbar</a>-->\n  <!--      <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">-->\n  <!--  <span class=\"navbar-toggler-icon\"></span>-->\n  <!--</button>-->\n\n  <!--      <div class=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">-->\n  <!--          <ul class=\"navbar-nav mr-auto\">-->\n  <!--              <li class=\"nav-item active\">-->\n  <!--                  <a class=\"nav-link\" href=\"../index.html\">Home <span class=\"sr-only\">(current)</span></a>-->\n  <!--              </li>-->\n  <!--              <li class=\"nav-item\">-->\n  <!--                  <a class=\"nav-link\" href=\"#\">Link</a>-->\n  <!--              </li>-->\n  <!--              <li class=\"nav-item dropdown\">-->\n  <!--                  <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">-->\n  <!--        Dropdown-->\n  <!--      </a>-->\n  <!--                  <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">-->\n  <!--                      <a class=\"dropdown-item\" href=\"#\">Action</a>-->\n  <!--                      <a class=\"dropdown-item\" href=\"#\">Another action</a>-->\n  <!--                      <div class=\"dropdown-divider\"></div>-->\n  <!--                      <a class=\"dropdown-item\" href=\"#\">Something else here</a>-->\n  <!--                  </div>-->\n  <!--              </li>-->\n  <!--              <li class=\"nav-item\">-->\n  <!--                  <a class=\"nav-link disabled\" href=\"#\">Disabled</a>-->\n  <!--              </li>-->\n  <!--          </ul>-->\n  <!--          <form class=\"form-inline my-2 my-lg-0\">-->\n  <!--              <input class=\"form-control mr-sm-2\" type=\"search\" placeholder=\"Search\" aria-label=\"Search\">-->\n  <!--              <button class=\"btn btn-outline-success my-2 my-sm-0\" type=\"submit\">Search</button>-->\n  <!--          </form>-->\n  <!--      </div>-->\n  <!--  </nav>-->\n    <!--navbar end-->\n\n\n    <!--header-->\n\n\n    <!--header end-->\n\n\n\n    <!--Log in-->\n    \n    <?php\n    \n    // Made log in myself for testing when doing the page individually form start\n        \n        // echo \"\n        // <div class='col-md-8 order-md-1'>\n        // <form method='POST' action='\".getLogin($db).\"'>\n        //     <div class='form-group'>\n        //     Email&nbsp;:&nbsp;<input type='text' name='rep_email' id='rep_email'>\n        //     </div>\n        //     <div class='form-group'>\n        //     <button type='submit' name='loginSubmit' class='btn btn-primary'>Login</button>\n        //     </div>\n        // </form>\";\n        \n        // echo \"\n        // <form method='POST' action='\".userLogout($db).\"'>\n        //     <div class='form-group'>\n        //     <button type='submit' name='logoutSubmit' class='btn btn-primary'>Logout</button>\n        //     </div>\n        // </form>\n        // </div>\";\n        \n        // if(isset($_SESSION['company_id'])){\n        //     echo \"\n        //     <div class='col-md-8 order-md-1'>\n        //     <p>You are Login.</p>\n        //     </div>\";\n        // } else{\n        //     echo \"\n        //     <div class='col-md-8 order-md-1'>\n        //     <p>You not Login.</p>\n        //     </div>\";\n        // }\n        \n    ?>\n    <!--Log in end-->\n    \n    <!--If not Log in/ Input box hidden-->\n    <center>\n            <div class='col-md-8 order-md-1'>\n            <br>\n            <a href='company_add/showEvent.php'><button class='btn btn-warning btn-lg btn-block' >View Event</button></a>\n            </div>\n            <br>\n        <div class='col-md-8 order-md-1' style='border-radius: 15px; background-color:#dab59b;'>\n            <br>\n            <br>\n        <h4 class='mb-3'>Event Add Page</h4>\n        \n        \n        <form action=\"\" method=\"post\">\n         \n         <!--userid-->\n            <div class='form-group'>\n                <input name='company_id' type='text' class='form-control' value='<?php echo $company_id ?>' hidden='true'> <!-- $company_id is defined in the header.php -->\n            </div>\n            \n            <!--Name of Event-->\n            <div class='form-group'>\n                <b><label for='event_name' class='control-label'>Name of Event</label><font color=\"red\"><sup>*</sup></font></b>\n                <input name='event_name' id='event_name' class='form-control' pattern='[a-zA-Z0-9\\s]{1,20}' title='Letters and numbers only, max 20 characters.' type='text' class='form-control' placeholder='' required>\n            </div>\n\n            <!--Description-->\n            <div class='form-group'>\n                <b><label for='description' class='control-label'>Description</label><font color=\"red\"><sup>*</sup></font></b>\n                <textarea name='description' id='description' class='form-control' pattern='[a-zA-Z0-9\\s]{50,255}' onkeyup=\"countChar(this)\" placeholder=\"Minimun of 50 characters\" title='Letters and numbers only.' class='form-control' rows='5'  maxlength='255'required></textarea>\n                Characters left: <qqq id=\"charNum\">255</qqq>/255\n            </div>\n\n            <!--Address-->\n            <div class='form-group'>\n                <b><label for='event_address1' class='control-label'>Address Line 1</label><font color=\"red\"><sup>*</sup></font></b>\n                <input name='event_address1' id='event_address1' class='form-control' pattern='^[a-zA-Z0-9\\s,]*$' title='Letters and numbers only.' placeholder='Where is the event being held?' type='text' required class='form-control'>\n            </div>\n\n            <!--Address2-->\n            <div class='form-group'>\n                <b><label for='event_address2' class='control-label'>Address Line 2</label></b>\n                <input name='event_address2' id='event_address2' class='form-control' pattern='^[a-zA-Z0-9\\s,.]*$'  title='Letters and numbers only.' type='text' class='form-control'>\n            </div>\n\n            <!--Row Start City/Eircode-->\n            <div class='form-group'>\n                <div class='row'>\n\n                    <!--Selecter City-->\n                    <div class='col-md-4 mb-3'>\n                        <b><label for='event_city' class='control-label'>City</label></b>\n                        <input name='event_city' id='event_city' class='form-control' pattern='[a-zA-Z0-9]{1,100}' title='Letters and numbers only.' type='text' class='form-control'>\n\n                    </div>\n\n                    <!--Eircode-->\n                    <div class='col-md-3 mb-3'>\n                        <b><label for='event_eircode' class='control-label'>Eircode</label></b>\n                        <input name='event_eircode' id='event_eircode' class='form-control' pattern='[a-zA-Z0-9\\s]{7}' title='Letters and numbers only.' type='text' placeholder='' maxlength='7' class='form-control'>\n                    </div>\n                </div>\n                <!--Row Finish-->\n            </div>\n            \n            <!--Row Start Date/Time-->\n            <div class='form-group'>\n                <div class='row'>\n\n                    <!--Choose Date-->\n                    <div class='col-md-5 mb-3'>\n                        <b><label class='search-lab'>Date</label><font color=\"red\"><sup>*</sup></font></b>\n                        <input type='date' name='date' id='date' class='form-control' placeholder='YYYY-MM-DD' required pattern='[0-9]{4}-[0-9]{2}-[0-9]{2}' title='Enter a date in this format YYYY-MM-DD'/>\n\n                    </div>\n\n                    <!--Put Start Time-->\n                    <div class='col-md-4 mb-3'>\n                        <b><label class='search-lab'>Start Time</label><font color=\"red\"><sup>*</sup></font></b>\n                        <input type='time' name='start_time' required class='form-control' pattern='[0-9]{2}:[0-9]{2}' title='Enter a time in the 24-hour format HH:MM'/>\n                    </div>\n                    \n                    <!--Put End Time-->\n                    <div class='col-md-3 mb-3'>\n                        <b><label class='search-lab'>End Time</label></b>\n                        <input type='time' name='end_time' class='form-control' pattern='[0-9]{2}:[0-9]{2}' title='Enter a time in the 24-hour format HH:MM'/>\n                    </div>\n                    \n                </div>\n                <!--Row Finish-->\n            </div>\n            \n            <div class='col-md-8 order-md-1'>\n              <p><b><font color=\"red\"><sup>*</sup></font> means required field</p>\n            </div>\n            \n            <br>\n        </div>    \n            <br>\n            \n            <div class='col-md-8 order-md-1'>\n            <div class='form-group'>\n              <input class='btn btn-primary btn-lg btn-block' type=\"submit\" value=\"Submit\">\n            </div>\n                <br>                \n        </form>\n                        </div>\n                        </center>\n                        <br>\n\n\n      <?php\n                    if(!isset($bFieldRequired)){\n                        echo (\"\");\n                    }\n                    else if(isset($bFieldRequired) && $bFieldRequired){\n                        echo (\"Required fields not completed\");\n                    }\n                    else if (isset($successDB) && !$successDB){\n                        echo (\"<font color='red'>Sorry, an error occured. We are aware of this issue and working to fix it. <br><br> Technical information: \".$db->error.\"</font>\");\n                        //header( 'Location: ../../error.html' ) ;\n                    }\n                    else if (isset($successDB) && $successDB){\n                        echo (\"<font color='#3eb740'>Thank you. Your event has been created and is queued for approvial.</font>\");\n                    }\n                    ?>\n        </div>\n\n\n    \n\n\n\n<!--old footer-->\n        <!--<footer class=\"my-5 pt-5 text-muted text-center text-small\">-->\n        <!--    <p class=\"mb-1\">&copy; 2017-2018 Company Name</p>-->\n        <!--    <ul class=\"list-inline\">-->\n        <!--        <li class=\"list-inline-item\"><a href=\"#\">Privacy</a></li>-->\n        <!--        <li class=\"list-inline-item\"><a href=\"#\">Terms</a></li>-->\n        <!--        <li class=\"list-inline-item\"><a href=\"#\">Support</a></li>-->\n        <!--    </ul>-->\n        <!--</footer>-->\n\n        <!-- Optional JavaScript -->\n        <!-- jQuery first, then Popper.js, then Bootstrap JS -->\n\n        <!--<script type=\"text/javascript\" src=\"js/jquery.js\"></script>-->\n        <!--<script type=\"text/javascript\" src=\"js/jquery.ui.js\"></script>-->\n        <!--<script type=\"text/javascript\" src=\"js/bootstrap-timepicker.min.js\"></script>-->\n\n</body>\n  <?php echo $footer_msg ?>\n</html>\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":1260,"scrollleft":0,"selection":{"start":{"row":31,"column":23},"end":{"row":31,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":89,"state":"js-start","mode":"ace/mode/php"}},"timestamp":1531479550190}